---
layout: post
status: publish
published: true
title: How to obtain the IP address of the current user
author:
  display_name: Kev.in
  login: Kevin
  email: kevin@kev.in
  url: http://kev.in
author_login: Kevin
author_email: kevin@kev.in
author_url: http://kev.in
excerpt: ! "<img class=\"alignright\" src=\"{{ site.image_path }}/address.jpg\" title=\"Some
  house address\" alt=\"Some house address\" height=\"88\" width=\"160\" />\r\n<p>Web
  applications can receive requests directly, via a CGI process, through proxy servers,
  relayed from front-end web servers, and so on. This can complicate how you might
  find out where the request originated if you, for example, wanted to limit an online
  poll to one vote per IP address. Luckily, Rails consolidates most of the ways to
  get this info into a single convenience method on the <code>request</code> object
  for us.</p>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"
wordpress_id: 113
wordpress_url: http://railsauthority.com/tutorial/how-to-obtain-the-ip-address-of-the-current-user
date: !binary |-
  MjAwNy0wOC0yNiAyMjo1NjozOCAtMDcwMA==
date_gmt: !binary |-
  MjAwNy0wOC0yNyAwNTo1NjozOCAtMDcwMA==
categories:
- Controllers
tags: []
comments:
- id: 13086
  author: Aaron J.
  author_email: stmikul@hotmail.com
  author_url: ''
  date: !binary |-
    MjAwOC0wMS0xOCAwMjowNzoxNyAtMDgwMA==
  date_gmt: !binary |-
    MjAwOC0wMS0xOCAwOTowNzoxNyAtMDgwMA==
  content: Do you have any advice on how I can take this a step further? I am looking
    to limit a given user to one vote per session but I'm not sure how to achieve
    this. I'd appreciate any help you can offer. Thanks for your time.
- id: 13087
  author: Kevin
  author_email: kevin@railsauthority.com
  author_url: http://
  date: !binary |-
    MjAwOC0wMS0xOCAwOTo1OTowMyAtMDgwMA==
  date_gmt: !binary |-
    MjAwOC0wMS0xOCAxNjo1OTowMyAtMDgwMA==
  content: Aaron, that's a good idea for an article :) See <a href="/tutorial/how-to-limit-users-to-one-vote-per-ip-address"
    rel="nofollow">How to limit users to one vote per IP address</a>.
- id: 13088
  author: Finding the correct IP address in Rails
  author_email: ''
  author_url: http://www.suite75.net/blog/dev/finding-the-correct-ip-address-in-rails.html
  date: !binary |-
    MjAwOC0wNC0wMyAwNTo0ODo1MCAtMDcwMA==
  date_gmt: !binary |-
    MjAwOC0wNC0wMyAxMjo0ODo1MCAtMDcwMA==
  content: ! '[...] I just found out that request.remote_ip does the same as my function.
    Unfortunately, it only works in Rails 2.0.     [...]'
- id: 13089
  author: Floorplanner Tech Blog &raquo; Blog Archive &raquo; Finding the correct
    IP address in Rails
  author_email: ''
  author_url: http://techblog.floorplanner.com/2008/04/03/finding-the-correct-ip-address-in-rails/
  date: !binary |-
    MjAwOC0wNy0xMiAwMTo0MjoxMiAtMDcwMA==
  date_gmt: !binary |-
    MjAwOC0wNy0xMiAwODo0MjoxMiAtMDcwMA==
  content: ! '[...] I just found out that request.remote_ip does the same as my determine_ip-function.
    Unfortunately, it only works in [...]'
- id: 13090
  author: greg
  author_email: greg@greg.net.nz
  author_url: ''
  date: !binary |-
    MjAwOC0wOC0xNCAwMToxNDo0OSAtMDcwMA==
  date_gmt: !binary |-
    MjAwOC0wOC0xNCAwODoxNDo0OSAtMDcwMA==
  content: thanks dude, this was actually useful.
- id: 13953
  author: ! "[]  Ruby on Rails \x81 IP \x81 &laquo; YORKXINYORKXIN"
  author_email: ''
  author_url: http://chitsaou.wordpress.com/2009/01/17/rails-ip-filter/
  date: !binary |-
    MjAwOS0wMS0xNiAyMjo1Nzo1NSAtMDgwMA==
  date_gmt: !binary |-
    MjAwOS0wMS0xNyAwNjo1Nzo1NSAtMDgwMA==
  content: ! '[...] How to obtain the IP address of the current user | kev.in: [...]'
- id: 26693
  author: user
  author_email: ssiey@gss.com
  author_url: ''
  date: !binary |-
    MjAwOS0xMi0xMiAxNDowNToyNCAtMDgwMA==
  date_gmt: !binary |-
    MjAwOS0xMi0xMiAyMjowNToyNCAtMDgwMA==
  content: Good sample.
- id: 47234
  author: Louie
  author_email: louie728@gmail.com
  author_url: ''
  date: !binary |-
    MjAxMS0wOS0yMyAxMTowMzoyMSAtMDcwMA==
  date_gmt: !binary |-
    MjAxMS0wOS0yMyAxOTowMzoyMSAtMDcwMA==
  content: Hi I want to track the IP of user but am getting the IP address to my servers
    gateway..
- id: 225787
  author: soccer
  author_email: jensalaniz@freenet.de
  author_url: http://evieoqjrcbfs.wordpress.com/
  date: !binary |-
    MjAxNC0wOS0xOSAxODoyMDoxMSAtMDcwMA==
  date_gmt: !binary |-
    MjAxNC0wOS0yMCAwMjoyMDoxMSAtMDcwMA==
  content: ! "If you're a coach on your own, here are a few \r\ntips to make sure
    your goalie gets proper training and attention. With the launch of i \r\n- Soccer,
    Leber is aiming to spark individual and team development in technical skills and,\r\ndown
    the road, identify trends in technical development from the scores on the online
    program, whose participants range from \r\nsix years old to college age. This
    is so that you can switch up once in a while and prevent your mind and body from
    getting bored quickly."
- id: 226770
  author: imvu credits generator
  author_email: deb_chittenden@web.de
  author_url: http://imvucreditgeneratorz.wordpress.com/
  date: !binary |-
    MjAxNC0xMC0wNSAyMjoxMTozMSAtMDcwMA==
  date_gmt: !binary |-
    MjAxNC0xMC0wNiAwNjoxMTozMSAtMDcwMA==
  content: ! "Very good blog! Do you have any suggestions for aspiring writers?\r\nI'm
    planning to start my own site soon but I'm a little lost on everything.\r\nWould
    you advise starting with a free platform like Wordpress or \r\ngo for a paid option?
    There are so many options out there \r\nthat I'm totally overwhelmed .. Any ideas?
    \r\nThank you!"
---
<p><img class="alignright" src="{{ site.image_path }}/address.jpg" title="Some house address" alt="Some house address" height="88" width="160" /></p>
<p>Web applications can receive requests directly, via a CGI process, through proxy servers, relayed from front-end web servers, and so on. This can complicate how you might find out where the request originated if you, for example, wanted to limit an online poll to one vote per IP address. Luckily, Rails consolidates most of the ways to get this info into a single convenience method on the <code>request</code> object for us.</p>
<p><a id="more"></a><a id="more-113"></a></p>
<h3>The Convenience Method: <code>#remote_ip</code></h3>
<p>Without the <code>request.remote_ip</code> method, you'd have to look for specific headers that are used to carry this data in the HTTP request beyond the server where the actual client's connection was terminated.</p>
<p>Rails' <code>request.remote_ip</code> method is pretty smart: it looks for and parses the headers <code>HTTP_CLIENT_IP</code>, <code>HTTP_X_FORWARDED_FOR</code> and <code>REMOTE_ADDR</code> and parse the value which are commonly used for this purpose.</p>
<h3>Example Rails Code</h3>
<p class="code-source">In <span class="filename">RAILS_ROOT/app/controllers/show_my_ip_controller.rb</span>:</p>
{% highlight ruby %}
class ShowMyIpController > ApplicationController

  def index
    @client_ip = request.remote_ip
  end

end
{% endhighlight %}
<p class="code-source">In <span class="filename">RAILS_ROOT/app/views/show_my_ip/index.html.erb</span>:</p>
{% highlight html %}
Your IP address is <%= @client_ip >
{% endhighlight %}
<h3>Further Reading</h3>
<p>The <code>request.remote_ip</code> method is documented in the <a href="http://api.rubyonrails.org/classes/ActionController/AbstractRequest.html#M000235">Rails Framework rdocs</a>.</p>
<h3>Feedback and Article Ideas</h3>
<p>Want to see a topic explored here? <a href="https://twitter.com/{{ site.twitter_username }}">Send Me a Message</a>.</p>
